---
title: From JSON Schema
description: 'Import and work with existing JSON Schema definitions'
icon: 'file-json'
---

Import existing JSON Schema definitions and convert them into schema objects for validation and manipulation. This feature allows you to work with external schemas, migrate from other tools, or load schemas from configuration files.

## Basic JSON Schema Import

Import a schema from a JSON string:

```php
use Cortex\JsonSchema\Schema;
use Cortex\JsonSchema\Enums\SchemaVersion;

// JSON Schema as string
$jsonString = '{
    "type": "object",
    "title": "User",
    "properties": {
        "name": {
            "type": "string",
            "minLength": 2,
            "maxLength": 100
        },
        "email": {
            "type": "string",
            "format": "email"
        },
        "age": {
            "type": "integer",
            "minimum": 0,
            "maximum": 150
        }
    },
    "required": ["name", "email"]
}';

// Import JSON Schema
$schema = Schema::fromJson($jsonString);

// Use the imported schema for validation
$userData = [
    'name' => 'John Doe',
    'email' => 'john@example.com',
    'age' => 30
];

$schema->isValid($userData); // true
```

## Import from Array

Import a schema from a PHP array representation:

```php
$schemaArray = [
    'type' => 'object',
    'title' => 'Product',
    'description' => 'E-commerce product schema',
    'properties' => [
        'sku' => [
            'type' => 'string',
            'pattern' => '^[A-Z]{3}-\d{4}$',
            'description' => 'Product SKU'
        ],
        'name' => [
            'type' => 'string',
            'minLength' => 1,
            'maxLength' => 200
        ],
        'price' => [
            'type' => 'number',
            'minimum' => 0,
            'multipleOf' => 0.01
        ],
        'categories' => [
            'type' => 'array',
            'items' => [
                'type' => 'string'
            ],
            'maxItems' => 5,
            'uniqueItems' => true
        ],
        'in_stock' => [
            'type' => 'boolean',
            'default' => true
        ]
    ],
    'required' => ['sku', 'name', 'price'],
    'additionalProperties' => false
];

// Import from array
$productSchema = Schema::fromJson($schemaArray);
```

<Accordion title="Imported Schema Usage">
```php
// Validate product data
$productData = [
    'sku' => 'ABC-1234',
    'name' => 'Wireless Headphones',
    'price' => 99.99,
    'categories' => ['electronics', 'audio'],
    'in_stock' => true
];

$productSchema->isValid($productData); // true

// Convert back to JSON
$jsonOutput = $productSchema->toJson(JSON_PRETTY_PRINT);
echo $jsonOutput;
```
</Accordion>

## Schema Version Detection and Specification

Import schemas with specific versions or detect automatically:

```php
// Draft 2019-09 schema with $defs
$modern_schema_json = '{
    "$schema": "https://json-schema.org/draft/2019-09/schema",
    "type": "object",
    "title": "ModernUser",
    "$defs": {
        "address": {
            "type": "object",
            "properties": {
                "street": { "type": "string" },
                "city": { "type": "string" },
                "country": { "type": "string" }
            },
            "required": ["street", "city", "country"]
        }
    },
    "properties": {
        "name": { "type": "string" },
        "email": { "type": "string", "format": "email" },
        "deprecated_field": {
            "type": "string",
            "deprecated": true
        },
        "home_address": { "$ref": "#/$defs/address" },
        "work_address": { "$ref": "#/$defs/address" }
    },
    "required": ["name", "email"],
    "unevaluatedProperties": false
}';

// Import with automatic version detection
$modernSchema = Schema::fromJson($modern_schema_json);

// Or specify version explicitly
$explicitSchema = Schema::fromJson(
    $modern_schema_json,
    SchemaVersion::Draft_2019_09
);
```

## Complex Schema with References

Import schemas with definitions and references:

```php
$complex_api_schema = [
    '$schema' => 'http://json-schema.org/draft-07/schema#',
    'type' => 'object',
    'title' => 'APIResponse',
    'definitions' => [
        'user' => [
            'type' => 'object',
            'properties' => [
                'id' => ['type' => 'string'],
                'username' => ['type' => 'string'],
                'email' => ['type' => 'string', 'format' => 'email'],
                'profile' => ['$ref' => '#/definitions/profile']
            ],
            'required' => ['id', 'username', 'email']
        ],
        'profile' => [
            'type' => 'object',
            'properties' => [
                'first_name' => ['type' => 'string'],
                'last_name' => ['type' => 'string'],
                'avatar_url' => ['type' => 'string', 'format' => 'uri'],
                'bio' => ['type' => 'string', 'maxLength' => 500]
            ]
        ],
        'pagination' => [
            'type' => 'object',
            'properties' => [
                'page' => ['type' => 'integer', 'minimum' => 1],
                'per_page' => ['type' => 'integer', 'minimum' => 1, 'maximum' => 100],
                'total' => ['type' => 'integer', 'minimum' => 0],
                'total_pages' => ['type' => 'integer', 'minimum' => 0]
            ],
            'required' => ['page', 'per_page', 'total', 'total_pages']
        ]
    ],
    'properties' => [
        'success' => ['type' => 'boolean'],
        'data' => [
            'oneOf' => [
                ['$ref' => '#/definitions/user'],
                [
                    'type' => 'array',
                    'items' => ['$ref' => '#/definitions/user']
                ]
            ]
        ],
        'pagination' => ['$ref' => '#/definitions/pagination'],
        'message' => ['type' => 'string']
    ],
    'required' => ['success']
];

$apiSchema = Schema::fromJson($complex_api_schema);

// Validate API responses
$singleUserResponse = [
    'success' => true,
    'data' => [
        'id' => 'user_123',
        'username' => 'johndoe',
        'email' => 'john@example.com',
        'profile' => [
            'first_name' => 'John',
            'last_name' => 'Doe',
            'bio' => 'Software developer'
        ]
    ]
];

$apiSchema->isValid($singleUserResponse); // true
```

## Loading from Files

Load schemas from external files:

```php
/**
 * Load schema from file
 */
function loadSchemaFromFile(string $filepath): Schema
{
    if (!file_exists($filepath)) {
        throw new InvalidArgumentException("Schema file not found: {$filepath}");
    }

    $content = file_get_contents($filepath);
    $schemaData = json_decode($content, true);

    if (json_last_error() !== JSON_ERROR_NONE) {
        throw new InvalidArgumentException("Invalid JSON in schema file: " . json_last_error_msg());
    }

    return Schema::fromJson($schemaData);
}

// Usage
$userSchema = loadSchemaFromFile('schemas/user.json');
$productSchema = loadSchemaFromFile('schemas/product.json');
$orderSchema = loadSchemaFromFile('schemas/order.json');
```

## Best Practices

### 1. Validate JSON Before Import

```php
function safeJsonImport(string $jsonString): Schema
{
    $data = json_decode($jsonString, true);

    if (json_last_error() !== JSON_ERROR_NONE) {
        throw new InvalidArgumentException(
            "Invalid JSON: " . json_last_error_msg()
        );
    }

    // Basic schema validation
    if (!isset($data['type'])) {
        throw new InvalidArgumentException("Schema must have a 'type' property");
    }

    return Schema::fromJson($data);
}
```

### 2. Handle Schema Dependencies

```php
function resolveSchemaReferences(array $schema, array $definitions = []): array
{
    // Recursively resolve $ref properties
    foreach ($schema as $key => $value) {
        if ($key === '$ref' && is_string($value)) {
            // Resolve reference to actual schema
            $refPath = str_replace('#/definitions/', '', $value);
            if (isset($definitions[$refPath])) {
                return $definitions[$refPath];
            }
        } elseif (is_array($value)) {
            $schema[$key] = resolveSchemaReferences($value, $definitions);
        }
    }

    return $schema;
}
```

### 3. Version Compatibility Checking

```php
function checkVersionCompatibility(array $schema): void
{
    $schemaVersion = $schema['$schema'] ?? '';

    $supportedVersions = [
        'http://json-schema.org/draft-07/schema#',
        'https://json-schema.org/draft/2019-09/schema',
        'https://json-schema.org/draft/2020-12/schema'
    ];

    if ($schemaVersion && !in_array($schemaVersion, $supportedVersions)) {
        throw new InvalidArgumentException(
            "Unsupported schema version: {$schemaVersion}"
        );
    }
}
```

### 4. Schema Caching

```php
class CachedSchemaLoader
{
    private array $cache = [];

    public function load(string $filepath): Schema
    {
        $cacheKey = md5($filepath . filemtime($filepath));

        if (!isset($this->cache[$cacheKey])) {
            $this->cache[$cacheKey] = loadSchemaFromFile($filepath);
        }

        return $this->cache[$cacheKey];
    }
}
```

## Common Use Cases

<CardGroup cols={2}>
  <Card title="API Documentation" icon="api">
    Import OpenAPI schemas for request/response validation in API applications.
  </Card>
  <Card title="Configuration Management" icon="gear">
    Validate application configuration files using predefined JSON schemas.
  </Card>
  <Card title="Data Migration" icon="exchange-alt">
    Import legacy schemas and validate data during migration processes.
  </Card>
  <Card title="Third-party Integration" icon="plug">
    Work with external JSON schemas from APIs, services, or documentation.
  </Card>
</CardGroup>

## Next Steps

<CardGroup cols={2}>
  <Card
    title="Data Validation"
    icon="check-circle"
    href="/validation/data-validation"
  >
    Learn to validate data with imported schemas
  </Card>
  <Card
    title="Schema Factory"
    icon="factory"
    href="/api-reference/schema-factory"
  >
    Explore the complete Schema Factory API reference
  </Card>
</CardGroup>
